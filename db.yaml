- name : configure the db module 
  hosts: db 
  become: true 
  vars: 
    mysql_root_passwd: ExpenseApp@1 
    login_host: db.78skedar.online
  gather_facts: yes 
  tasks:
    - name: install the mysql server 
      ansible.builtin.dnf:
        name: mysql-server
        state: latest

    - name: enable and start the mysql
      ansible.builtin.service:
        name: mysqld 
        state: started
        enabled: yes 

    - name: install the python mysql  dependecies 
      ansible.builtin.pip:
        name: 
        - PyMySQL
        - cryptography
      executable: pip3.9
      

    - name: check the myqsl root password setuped or not 
      community.mysql.mysql_info:
        login_user: root
        login_password: "{{ mysql_root_passwd }}"
        login_host: "{{ login_host }}"
        filter: version
      ignore_errors: yes 
      register: mysql

    - name: print the mysql info 
      ansible.builtin.debug:
        msg: "mysql info is {{ mysql }}"
        
    